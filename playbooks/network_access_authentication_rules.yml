- hosts: ise_servers
  gather_facts: no
  tasks:

  # - name: Get all
  #   cisco.ise.network_access_authentication_rules_info:
  #     ise_hostname: "{{ise_hostname}}"
  #     ise_username: "{{ise_username}}"
  #     ise_password: "{{ise_password}}"
  #     ise_verify: "{{ise_verify}}"
  #   register: result

  # - name: Print all
  #   ansible.builtin.debug:
  #     var: result

  # - name: Get by id
  #   cisco.ise.network_access_authentication_rules_info:
  #     ise_hostname: "{{ise_hostname}}"
  #     ise_username: "{{ise_username}}"
  #     ise_password: "{{ise_password}}"
  #     ise_verify: "{{ise_verify}}"
  #     id: d704e911-a916-11eb-8830-2ec507028ea8
  #   register: result

  - name: Create or update an network_access_authentication_rules
    cisco.ise.network_access_authentication_rules:
      ise_hostname: "{{ise_hostname}}"
      ise_username: "{{ise_username}}"
      ise_password: "{{ise_password}}"
      ise_verify: "{{ise_verify}}"
      state: present
      rule: 
        default: False
        name: "Test2"
        hitCounts: 0
        rank: 0
        state: "disabled"
        condition:
          conditionType: "ConditionReference"
          isNegate: False
          dictionaryName: "Network Access"
          attributeName: "EapAuthentication"
          operator: "equals"
          attributeValue: "EAP-MSCHAPv2"
          name: "EAP-MSCHAPv2"
          id: "c456a490-0429-4fd4-91d7-efd1eb1f855a"
      ifAuthFail: "REJECT"
      ifUserNotFound: "REJECT"
      ifProcessFail: "DROP"
      policyId: cb32c3bc-c720-40c3-83e4-8897f9dd6943
    register: result

  - name: Print result
    ansible.builtin.debug:
      var: result